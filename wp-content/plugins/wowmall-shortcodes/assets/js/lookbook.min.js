!function(o){"use strict";function l(l){o(".wowmall-lookbook-point.mouse").css({top:l.pageY-o(this).offset().top,left:l.pageX-o(this).offset().left})}function e(f){o(".wowmall-lookbook-point.mouse").removeClass("mouse").draggable({drag:function(o,l){s.css({top:l.position.top,left:l.position.left})}}),s.css({top:f.pageY-o(this).offset().top,left:f.pageX-o(this).offset().left}).show().find(".btn-remove").hide(),o(".wowmall-lookbook-point[id]").off("click",n),m.find("option").not("[disabled]").first().prop("selected",!0),a.off("mousemove",t).off("mouseleave",i).off("mousemove",l).off("click",e),p.val("")}function t(){o(".wowmall-lookbook-point.mouse").length||a.after('<span class="wowmall-lookbook-point mouse"/>')}function i(){o(".wowmall-lookbook-point.mouse").remove()}function n(f){var k=o(f.target).attr("id");o(".wowmall-lookbook-point[id]").off("click",n),s.css({top:o(f.target).css("top"),left:o(f.target).css("left")}).show(),m.find("option").prop("selected",!1),m.find("option[value="+k+"]").prop("disabled",!1).prop("selected",!0),p.val(k),s.find(".btn-remove").show(),a.off("mousemove",t).off("mouseleave",i).off("mousemove",l).off("click",e),o(f.target).draggable({drag:function(o,l){s.css({top:l.position.top,left:l.position.left})}})}var a=o("#wowmall-lookbook-slide img"),s=o(".wowmall-lookbook-popup"),p=o("#wowmall-lookbook-popup-prev-id"),m=o("#wowmall-lookbook-popup-select"),f=o("#wowmall-lookbook-slide").closest("form#post").find("input#post_ID").val();a.on("mousemove",t).on("mouseleave",i).on("mousemove",l).on("click",e),s.find(".btn-cancel").on("click",function(){s.hide();var f=p.val();o(".wowmall-lookbook-point").not(".mouse").not("[id]").remove(),""!==f&&(o(".wowmall-lookbook-point#"+f).draggable("destroy"),m.find("option[value="+f+"]").prop("disabled",!0)),o(".wowmall-lookbook-point[id]").on("click",n),a.on("mousemove",t).on("mouseleave",i).on("mousemove",l).on("click",e)}),s.find(".btn-ok").on("click",function(){var k=m.val(),d=100*(s.offset().left-a.offset().left)/a.width(),c=100*(s.offset().top-a.offset().top)/a.height(),w=p.val();""!==w?o(".wowmall-lookbook-point#"+w).append('<span class="wowmall-lookbook-loader"/>'):o(".wowmall-lookbook-point").not(".mouse").not("[id]").append('<span class="wowmall-lookbook-loader"/>'),o.post(ajaxurl,{action:"wowmall_lookbook_set_product",id:f,product_id:k,placeX:d,placeY:c,prev_id:p.val()},function(p){""!==w?(o(".wowmall-lookbook-point#"+w).draggable("destroy").attr({id:k}).find(".wowmall-lookbook-loader").remove(),m.find("option[value="+w+"]").prop("disabled",!1)):o(".wowmall-lookbook-point").not(".mouse").not("[id]").attr({id:k}).find(".wowmall-lookbook-loader").remove(),m.find("option[value="+k+"]").prop("disabled",!0),s.hide(),o(".wowmall-lookbook-point[id]").on("click",n),a.on("mousemove",t).on("mouseleave",i).on("mousemove",l).on("click",e)})}),o(".wowmall-lookbook-point[id]").on("click",n),s.find(".btn-remove").on("click",function(){var k=p.val();o(".wowmall-lookbook-point#"+k).append('<span class="wowmall-lookbook-loader"/>'),o.post(ajaxurl,{action:"wowmall_lookbook_unset_product",id:f,product_id:k},function(f){o(".wowmall-lookbook-point#"+k).remove(),m.find("option[value="+k+"]").prop("disabled",!1),s.hide(),o(".wowmall-lookbook-point[id]").on("click",n),a.on("mousemove",t).on("mouseleave",i).on("mousemove",l).on("click",e),p.val("")})})}(jQuery);